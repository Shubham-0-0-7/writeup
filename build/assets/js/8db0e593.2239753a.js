"use strict";(globalThis.webpackChunkwriteup=globalThis.webpackChunkwriteup||[]).push([[4191],{5278:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>c,frontMatter:()=>l,metadata:()=>i,toc:()=>d});var i=s(7799),r=s(4848),t=s(8453);const l={title:"Bandit Level 13 \u2192 14",authors:["shubham"],tags:["bandit","overthewire","cybersecurity"]},o="Bandit Level 13 \u2192 14 \u2014 using a private SSH key",a={authorsImageUrls:[void 0]},d=[{value:"Quick solution (commands)",id:"quick-solution-commands",level:2},{value:"Theory (a bit more \u2014 why this works)",id:"theory-a-bit-more--why-this-works",level:2},{value:"Full explained session (step-by-step)",id:"full-explained-session-step-by-step",level:2},{value:"Example (what you might see)",id:"example-what-you-might-see",level:2},{value:"Cleanup &amp; security reminder",id:"cleanup--security-reminder",level:2}];function h(e){const n={br:"br",code:"code",em:"em",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Login"}),": ",(0,r.jsx)(n.code,{children:"ssh bandit13@bandit.labs.overthewire.org -p 2220"}),(0,r.jsx)(n.br,{}),"\n","(you already logged in as ",(0,r.jsx)(n.code,{children:"bandit13"})," and found ",(0,r.jsx)(n.code,{children:"sshkey.private"})," in the home directory)"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Task"})}),"\n",(0,r.jsxs)(n.p,{children:["You are given a private SSH key file (",(0,r.jsx)(n.code,{children:"sshkey.private"}),") in the ",(0,r.jsx)(n.code,{children:"bandit13"})," home directory. Use that key locally to connect to the ",(0,r.jsx)(n.code,{children:"bandit14"})," account. After you successfully ssh to ",(0,r.jsx)(n.code,{children:"bandit14"}),", read the file ",(0,r.jsx)(n.code,{children:"/etc/bandit_pass/bandit14"})," to get the next level password."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"quick-solution-commands",children:"Quick solution (commands)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# copy the private key from the remote host to your local machine\nscp -P 2220 bandit13@bandit.labs.overthewire.org:sshkey.private .\n\n# secure the key locally (OpenSSH requires strict permissions)\nchmod 600 sshkey.private\n\n# use the key to login as bandit14\nssh -i sshkey.private -p 2220 bandit14@bandit.labs.overthewire.org\n\n# once logged in as bandit14, read the password for the next level\ncat /etc/bandit_pass/bandit14\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"theory-a-bit-more--why-this-works",children:"Theory (a bit more \u2014 why this works)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Public-key SSH authentication"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Instead of a password, SSH can use an ",(0,r.jsx)(n.em,{children:"asymmetric key-pair"}),": a private key (which you keep secret) and a public key (stored on the server)."]}),"\n",(0,r.jsxs)(n.li,{children:["If the server has the corresponding public key in the ",(0,r.jsx)(n.code,{children:"authorized_keys"})," of an account, SSH proves you own the private key and logs you in as that account."]}),"\n",(0,r.jsxs)(n.li,{children:["In this level you were given the ",(0,r.jsx)(n.em,{children:"private"})," key for ",(0,r.jsx)(n.code,{children:"bandit14"}),". Possessing that key is equivalent to having the password for ",(0,r.jsx)(n.code,{children:"bandit14"})," (for authentication purposes)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"scp"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"scp"})," copies files over SSH. The ",(0,r.jsx)(n.code,{children:"-P 2220"})," option tells scp to use port ",(0,r.jsx)(n.code,{children:"2220"})," (Bandit uses that port)."]}),"\n",(0,r.jsxs)(n.li,{children:["Example: ",(0,r.jsx)(n.code,{children:"scp -P 2220 bandit13@...:sshkey.private ."})," copies ",(0,r.jsx)(n.code,{children:"sshkey.private"})," from the remote ",(0,r.jsx)(n.code,{children:"bandit13"})," home to your current local directory."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"File permissions matter"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["OpenSSH refuses to use private key files that are readable by group or others. If a private key file is group/world-readable SSH prints a warning like:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Permissions 0640 for 'sshkey.private' are too open.\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["The correct permission for private keys is `` (",(0,r.jsx)(n.code,{children:"-rw-------"}),") so that only the file owner can read/write it. ",(0,r.jsx)(n.code,{children:"700"})," (",(0,r.jsx)(n.code,{children:"-rwx------"}),") also works but is non-standard (private keys usually don't need execute bit)."]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"chmod 600 sshkey.private"})," to fix permissions."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Windows line endings"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If the key was moved through Windows or edited with a Windows editor, it may contain CRLF (",(0,r.jsx)(n.code,{children:" "}),") line endings. SSH expects Unix LF (",(0,r.jsx)(n.code,{children:" "}),"). Convert with ",(0,r.jsx)(n.code,{children:"dos2unix"})," or a ",(0,r.jsx)(n.code,{children:"tr"})," command if needed."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Troubleshooting"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If SSH refuses to authenticate, add verbose output to see why:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ssh -vvv -i sshkey.private -p 2220 bandit14@bandit.labs.overthewire.org\n"})}),"\n","Look for messages about ",(0,r.jsx)(n.code,{children:"Offering public key"})," and ",(0,r.jsx)(n.code,{children:"Authentication succeeded"})," or ",(0,r.jsx)(n.code,{children:"Permission denied"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["If you still get ",(0,r.jsx)(n.code,{children:"Permission denied (publickey)"}),", confirm:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The key file content is intact (no accidental edits)."}),"\n",(0,r.jsxs)(n.li,{children:["File permissions are ",(0,r.jsx)(n.code,{children:"600"})," and ownership is your user."]}),"\n",(0,r.jsxs)(n.li,{children:["You used the correct user (",(0,r.jsx)(n.code,{children:"bandit14"}),") and port (",(0,r.jsx)(n.code,{children:"2220"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"ssh-agent alternative"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Instead of passing ",(0,r.jsx)(n.code,{children:"-i"})," every time, add the key to your agent (keeps it in memory):","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ssh-add sshkey.private\nssh -p 2220 bandit14@bandit.labs.overthewire.org\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"full-explained-session-step-by-step",children:"Full explained session (step-by-step)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"On the remote server (bandit13)"})," \u2014 you discovered the key:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"bandit13@bandit:~$ ls\nsshkey.private\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"From your local machine"})," \u2014 copy the key here for use:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"scp -P 2220 bandit13@bandit.labs.overthewire.org:sshkey.private .\n# you will be prompted for the bandit13 password\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Secure the key file"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# make it readable only by you\nchmod 600 sshkey.private\n# verify\nls -l sshkey.private\n# output should look like: -rw------- 1 youruser yourgroup 1675 Sep 19 12:34 sshkey.private\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Attempt SSH using the key"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ssh -i sshkey.private -p 2220 bandit14@bandit.labs.overthewire.org\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["On first connect you'll likely be asked to accept the host fingerprint \u2014 answer ",(0,r.jsx)(n.code,{children:"yes"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["If the key works you'll be dropped into a shell as ",(0,r.jsx)(n.code,{children:"bandit14"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Read the next-level password"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cat /etc/bandit_pass/bandit14\n# this prints the password you need for the next level\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"example-what-you-might-see",children:"Example (what you might see)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ scp -P 2220 bandit13@bandit.labs.overthewire.org:sshkey.private .\nbandit13@bandit.labs.overthewire.org's password:\nsshkey.private                          100% 1675   1.6KB/s   00:00\n\n$ chmod 600 sshkey.private\n$ ssh -i sshkey.private -p 2220 bandit14@bandit.labs.overthewire.org\nThe authenticity of host '[bandit.labs.overthewire.org]:2220 ([IP]:2220)' can't be established.\nECDSA key fingerprint is SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.\nAre you sure you want to continue connecting (yes/no)? yes\nWelcome to bandit...\n$ cat /etc/bandit_pass/bandit14\n<the-password-for-bandit15>\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"cleanup--security-reminder",children:"Cleanup & security reminder"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["This is a game environment, but in real life ",(0,r.jsx)(n.strong,{children:"never"})," share private keys publicly (e.g., push them to GitHub). Remove keys from your local machine when you no longer need them:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"shred -u sshkey.private   # securely delete\n# or simply: rm sshkey.private\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If you ever suspect a private key has been exposed, revoke it on the server (remove the corresponding public key from ",(0,r.jsx)(n.code,{children:"~/.ssh/authorized_keys"}),") and generate a new key pair."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"If you want, I can:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["shorten this into a one-page ",(0,r.jsx)(n.code,{children:"README.md"})," suitable for GitHub, or"]}),"\n",(0,r.jsx)(n.li,{children:"create a small diagram explaining public/private key flow, or"}),"\n",(0,r.jsxs)(n.li,{children:["add the exact ",(0,r.jsx)(n.code,{children:"ssh -vvv"})," debugging output to the doc (if you paste your session output)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Tell me which you prefer and I will update the file."})]})}function c(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},7799:e=>{e.exports=JSON.parse('{"permalink":"/writeup/blog/2024/10/18/bandit-13-14","source":"@site/blog/2024-10-18-bandit-13-14.md","title":"Bandit Level 13 \u2192 14","description":"Login: ssh bandit13@bandit.labs.overthewire.org -p 2220\\\\","date":"2024-10-18T00:00:00.000Z","tags":[{"inline":true,"label":"bandit","permalink":"/writeup/blog/tags/bandit"},{"inline":true,"label":"overthewire","permalink":"/writeup/blog/tags/overthewire"},{"inline":true,"label":"cybersecurity","permalink":"/writeup/blog/tags/cybersecurity"}],"hasTruncateMarker":false,"authors":[{"name":"Shubham","title":"Cybersecurity Enthusiast","url":"https://github.com/Shubham-0-0-7","imageURL":"https://github.com/Shubham-0-0-7.png","key":"shubham","page":null}],"frontMatter":{"title":"Bandit Level 13 \u2192 14","authors":["shubham"],"tags":["bandit","overthewire","cybersecurity"]},"unlisted":false,"prevItem":{"title":"Bandit Level 1 \u2192 2","permalink":"/writeup/blog/2024/10/18/bandit-1-2"},"nextItem":{"title":"Bandit Level 14 \u2192 15","permalink":"/writeup/blog/2024/10/18/bandit-14-15"}}')},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);