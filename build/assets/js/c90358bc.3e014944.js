"use strict";(globalThis.webpackChunkwriteup=globalThis.webpackChunkwriteup||[]).push([[6694],{2042:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>h,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>l});var r=t(8369),o=t(4848),s=t(8453);const i={title:"Bandit Level 16 \u2192 17",authors:["shubham"],tags:["bandit","overthewire","cybersecurity"]},a=void 0,h={authorsImageUrls:[void 0]},l=[{value:"Bandit 16 to 17",id:"bandit-16-to-17",level:2},{value:"Task",id:"task",level:3},{value:"Quick theory",id:"quick-theory",level:3},{value:"Solution",id:"solution",level:3}];function c(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"bandit-16-to-17",children:"Bandit 16 to 17"}),"\n",(0,o.jsxs)(n.p,{children:["login : ssh ",(0,o.jsx)(n.a,{href:"mailto:bandit16@bandit.labs.overthewire.org",children:"bandit16@bandit.labs.overthewire.org"})," -p 2220",(0,o.jsx)(n.br,{}),"\n","password : kSkvUpMQ7lBYyCM4GBPvCvT1BfWRy0Dx"]}),"\n",(0,o.jsx)(n.h3,{id:"task",children:"Task"}),"\n",(0,o.jsx)(n.p,{children:"The credentials for the next level can be retrieved by submitting the password of the current level to a port on localhost in the range 31000 to 32000. First find out which of these ports have a server listening on them. Then find out which of those speak SSL and which don\u2019t. There is only 1 server that will give the next credentials, the others will simply send back to you whatever you send to it."}),"\n",(0,o.jsx)(n.h3,{id:"quick-theory",children:"Quick theory"}),"\n",(0,o.jsxs)(n.p,{children:["Bandit16 runs a set of TCP servers on localhost:31000\u201332000.",(0,o.jsx)(n.br,{}),"\n","Most servers simply echo back what you send.",(0,o.jsx)(n.br,{}),"\n","A few require SSL/TLS (openssl s_client can be used).",(0,o.jsx)(n.br,{}),"\n","The correct server will return a private key when you send the current password."]}),"\n",(0,o.jsxs)(n.p,{children:["Tools you\u2019ll use:",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.code,{children:"nmap"})," \u2192 find open ports and detect services.",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.code,{children:"nc"})," (netcat) \u2192 interact with non-SSL servers.",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.code,{children:"openssl s_client"})," \u2192 interact with SSL servers."]}),"\n",(0,o.jsx)(n.h3,{id:"solution",children:"Solution"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'bandit16@bandit:~$ nmap -sV localhost -p 31000-32000\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-23 19:23 UTC\n\nbandit16@bandit:~$ nmap -sV localhost -p 31000-32000\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-23 19:25 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.00012s latency).\nNot shown: 996 closed tcp ports (conn-refused)\nPORT      STATE SERVICE     VERSION\n31046/tcp open  echo\n31518/tcp open  ssl/echo\n31691/tcp open  echo\n31790/tcp open  ssl/unknown\n31960/tcp open  echo\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port31790-TCP:V=7.94SVN%T=SSL%I=7%D=9/23%Time=68D2F426%P=x86_64-pc-linu\nSF:x-gnu%r(GenericLines,32,"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x2\nSF:0current\\x20password\\.\\n")%r(GetRequest,32,"Wrong!\\x20Please\\x20enter\\x\nSF:20the\\x20correct\\x20current\\x20password\\.\\n")%r(HTTPOptions,32,"Wrong!\\\nSF:x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\.\\n")%r(RTS\nSF:PRequest,32,"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20\nSF:password\\.\\n")%r(Help,32,"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x\nSF:20current\\x20password\\.\\n")%r(FourOhFourRequest,32,"Wrong!\\x20Please\\x2\nSF:0enter\\x20the\\x20correct\\x20current\\x20password\\.\\n")%r(LPDString,32,"W\nSF:rong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\.\\n")\nSF:%r(SIPOptions,32,"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20curren\nSF:t\\x20password\\.\\n");\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 142.61 seconds\n'})}),"\n",(0,o.jsxs)(n.p,{children:["So, nmap tells us that five ports are open. Only two ports (31518 and 31790) use SSL. Nmap also tells us that port 31518 runs only the echo service. The promising port seems to be port 31790, which runs an unknown service.",(0,o.jsx)(n.br,{}),"\n","Now we use OpenSSL again to connect to this port on localhost and send the password."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"bandit16@bandit:~$ openssl s_client -connect localhost:31790 -quiet \nCan't use SSL_get_servername\ndepth=0 CN = SnakeOil\nverify error:num=18:self-signed certificate\nverify return:1\ndepth=0 CN = SnakeOil\nverify return:1\nkSkvUpMQ7lBYyCM4GBPvCvT1BfWRy0Dx\nCorrect!\n-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ\nimZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ\nJa6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu\nDSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW\nJGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX\nx0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD\nKHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl\nJ9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd\nd8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC\nYNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A\nvLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama\n+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT\n8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx\nSatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd\nHCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt\nSghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A\nR57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi\nTtiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg\nR8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu\nL8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni\nblh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU\nYOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM\n77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b\ndxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3\nvBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=\n-----END RSA PRIVATE KEY-----\n\nbandit16@bandit:~$ exit\nlogout\nConnection to bandit.labs.overthewire.org closed.\nshubhamdchhatbar@shubhams-MacBook-Air ~ % vim sshkey17.private\nshubhamdchhatbar@shubhams-MacBook-Air ~ % nano sshkey17.private     \nshubhamdchhatbar@shubhams-MacBook-Air ~ % nano sshkey17.private\nshubhamdchhatbar@shubhams-MacBook-Air ~ % chmod 700 sshkey17.private\nshubhamdchhatbar@shubhams-MacBook-Air ~ % ssh -i sshkey17.private bandit17@bandit.labs.overthewire.org p -2220\n\n                      This is an OverTheWire game server. \n            More information on http://www.overthewire.org/wargames\n\n!!! You are trying to log into this SSH server on port 22, which is not intended.\n!!! If you are trying to log in to an OverTheWire game, use the port mentioned in\n!!! the \"SSH Information\" on that game's webpage (in the top left corner).\n\nbandit17@bandit.labs.overthewire.org: Permission denied (publickey).\nshubhamdchhatbar@shubhams-MacBook-Air ~ % ssh -i sshkey17.private -p 2220 bandit17@bandit.labs.overthewire.org\n                         _                     _ _ _   \n                        | |__   __ _ _ __   __| (_) |_ \n                        | '_ \\ / _` | '_ \\ / _` | | __|\n                        | |_) | (_| | | | | (_| | | |_ \n                        |_.__/ \\__,_|_| |_|\\__,_|_|\\__|\n                                                       \n\n                      This is an OverTheWire game server. \n            More information on http://www.overthewire.org/wargames\n\nbackend: gibson-1\n\n      ,----..            ,----,          .---.\n     /   /   \\         ,/   .`|         /. ./|\n    /   .     :      ,`   .'  :     .--'.  ' ;\n   .   /   ;.  \\   ;    ;     /    /__./ \\ : |\n  .   ;   /  ` ; .'___,/    ,' .--'.  '   \\' .\n  ;   |  ; \\ ; | |    :     | /___/ \\ |    ' '\n  |   :  | ; | ' ;    |.';  ; ;   \\  \\;      :\n  .   |  ' ' ' : `----'  |  |  \\   ;  `      |\n  '   ;  \\; /  |     '   :  ;   .   \\    .\\  ;\n   \\   \\  ',  /      |   |  '    \\   \\   ' \\ |\n    ;   :    /       '   :  |     :   '  |--\"\n     \\   \\ .'        ;   |.'       \\   \\ ;\n  www. `---` ver     '---' he       '---\" ire.org\n\n\nWelcome to OverTheWire!\n\nIf you find any problems, please report them to the #wargames channel on\ndiscord or IRC.\n\n--[ Playing the games ]--\n\n  This machine might hold several wargames.\n  If you are playing \"somegame\", then:\n\n    * USERNAMES are somegame0, somegame1, ...\n    * Most LEVELS are stored in /somegame/.\n    * PASSWORDS for each level are stored in /etc/somegame_pass/.\n\n  Write-access to homedirectories is disabled. It is advised to create a\n  working directory with a hard-to-guess name in /tmp/.  You can use the\n  command \"mktemp -d\" in order to generate a random and hard to guess\n  directory in /tmp/.  Read-access to both /tmp/ is disabled and to /proc\n  restricted so that users cannot snoop on eachother. Files and directories\n  with easily guessable or short names will be periodically deleted! The /tmp\n  directory is regularly wiped.\n  Please play nice:\n\n    * don't leave orphan processes running\n    * don't leave exploit-files laying around\n    * don't annoy other players\n    * don't post passwords or spoilers\n    * again, DONT POST SPOILERS!\n      This includes writeups of your solution on your blog or website!\n\n--[ Tips ]--\n\n  This machine has a 64bit processor and many security-features enabled\n  by default, although ASLR has been switched off.  The following\n  compiler flags might be interesting:\n\n    -m32                    compile for 32bit\n    -fno-stack-protector    disable ProPolice\n    -Wl,-z,norelro          disable relro\n\n  In addition, the execstack tool can be used to flag the stack as\n  executable on ELF binaries.\n\n  Finally, network-access is limited for most levels by a local\n  firewall.\n\n--[ Tools ]--\n\n For your convenience we have installed a few useful tools which you can find\n in the following locations:\n\n    * gef (https://github.com/hugsy/gef) in /opt/gef/\n    * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/\n    * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/\n    * pwntools (https://github.com/Gallopsled/pwntools)\n    * radare2 (http://www.radare.org/)\n\n--[ More information ]--\n\n  For more information regarding individual wargames, visit\n  http://www.overthewire.org/wargames/\n\n  For support, questions or comments, contact us on discord or IRC.\n\n  Enjoy your stay!\n\nbandit17@bandit:\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8369:e=>{e.exports=JSON.parse('{"permalink":"/writeup/blog/2024/10/18/bandit-16-17","source":"@site/blog/2024-10-18-bandit-16-17.md","title":"Bandit Level 16 \u2192 17","description":"Bandit 16 to 17","date":"2024-10-18T00:00:00.000Z","tags":[{"inline":true,"label":"bandit","permalink":"/writeup/blog/tags/bandit"},{"inline":true,"label":"overthewire","permalink":"/writeup/blog/tags/overthewire"},{"inline":true,"label":"cybersecurity","permalink":"/writeup/blog/tags/cybersecurity"}],"hasTruncateMarker":false,"authors":[{"name":"Shubham","title":"Cybersecurity Enthusiast","url":"https://github.com/Shubham-0-0-7","imageURL":"https://github.com/Shubham-0-0-7.png","key":"shubham","page":null}],"frontMatter":{"title":"Bandit Level 16 \u2192 17","authors":["shubham"],"tags":["bandit","overthewire","cybersecurity"]},"unlisted":false,"prevItem":{"title":"Bandit Level 15 \u2192 16","permalink":"/writeup/blog/2024/10/18/bandit-15-16"},"nextItem":{"title":"Bandit Level 2 \u2192 3","permalink":"/writeup/blog/2024/10/18/bandit-2-3"}}')},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var r=t(6540);const o={},s=r.createContext(o);function i(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);